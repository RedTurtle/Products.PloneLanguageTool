<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      i18n:domain="plone">

<body>

<!-- The languages box -->

<div metal:define-macro="portlet"
     tal:define="PTS modules/Products/PlacelessTranslationService | nothing;"
     tal:condition="PTS">

    <div class="portlet"
         id="portlet-language"
         tal:define="served_languages here/portal_languages/listSupportedLanguages;
                     boundLanguages here/portal_languages/getLanguageBindings;
                     prefLang python:boundLanguages[0];">

        <h5 i18n:translate="label_language">Language</h5>

        <div class="portletBody">

            <form action="switchLanguage"
                  method="post"
                  tal:attributes="action string:${here/absolute_url}/switchLanguage" > 

                <label for="set_language">
                    <div class="hiddenLabel"
                         i18n:translate="label_choose_language">Choose your language</div>
                </label>

                <select name="set_language"
                        id="set_language"
                        onchange="this.form.submit()" >
                        alt="Choose your language"
                        title="Choose your language"
                        i18n:attributes="title">

                    <tal:block tal:repeat="lang served_languages">
                        <option value=""
                                tal:attributes="value python:lang[0];
                                                selected python:test(lang[0] == prefLang, 'selected', None)"
                                tal:content="python:here.portal_languages.getNameForLanguageCode(lang[0]) or lang[1]">Language</option>
                    </tal:block>

                </select>

            </form>

        </div>

    </div>

</div>

</body>

</html>
